### README: –£—Ç–∏–ª–∏—Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∫ –¥–æ–º–µ–Ω—É Active Directory

**PowerShell-—Å–∫—Ä–∏–ø—Ç –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–æ–º–ø—å—é—Ç–µ—Ä–æ–≤ –≤ –¥–æ–º–µ–Ω —Å –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫**

---

## ‚ö†Ô∏è –ö–ª—é—á–µ–≤—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
- **–ü—Ä–∞–≤–∞**: –õ–æ–∫–∞–ª—å–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä + —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–æ–º–µ–Ω–Ω–æ–≥–æ –∞–¥–º–∏–Ω–∞
- **–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞**:
  - –î–æ—Å—Ç—É–ø –∫ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—É –¥–æ–º–µ–Ω–∞
  - –°—Ç–∞–±–∏–ª—å–Ω–æ–µ —Å–µ—Ç–µ–≤–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
- **–í–µ—Ä—Å–∏—è PowerShell**: 5.1+

> **–í–∞–∂–Ω–æ!** –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–æ–∑–¥–∞–µ—Ç—Å—è –º–∞—Ä–∫–µ—Ä-—Ñ–∞–π–ª –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞.

---

## üõ† –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

| –§—É–Ω–∫—Ü–∏—è | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è | –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å |
|---------|-----------|--------------|
| –ê–≤—Ç–æ–ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ | `Test-IsAdmin` | üõ°Ô∏è –ó–∞—â–∏—Ç–∞ –æ—Ç —Å–ª—É—á–∞–π–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ |
| –í–∞–ª–∏–¥–∞—Ü–∏—è –≤–≤–æ–¥–∞ | `Get-ValidComputerName/Credentials` | üîí –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –≤–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö |
| –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–æ–≤—Ç–æ—Ä–∞ | –ú–∞—Ä–∫–µ—Ä-—Ñ–∞–π–ª –≤ `C:\Users\Public\` | ‚è≥ –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è |
| –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ | Try-Catch —Å –º–µ–Ω—é –ø–æ–≤—Ç–æ—Ä–∞ | üîÑ –£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ —Å–±–æ—è–º |
| –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ | –ü–∞—Ä–∞–º–µ—Ç—Ä `-Restart` –≤ `Add-Computer` | ‚ö° –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ |

---

## üöÄ –ó–∞–ø—É—Å–∫ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

### –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ä–µ–∂–∏–º (–∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π):
```powershell
powershell.exe -ExecutionPolicy Bypass -File "join_to_domain.ps1"
```
---

## ‚öôÔ∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### 1. –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
```powershell
$domain = "domain.local"  # –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à –¥–æ–º–µ–Ω
$markerPath = "C:\Users\Public\join_to_domain.marker"  # –ü—É—Ç—å –º–∞—Ä–∫–µ—Ä–∞
```

### 2. –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã
1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ ‚Üí –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∞—Ä–∫–µ—Ä–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è ‚Üí –≤—ã—Ö–æ–¥ –µ—Å–ª–∏ –Ω–∞–π–¥–µ–Ω
3. –í–≤–æ–¥ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è:
   - –ò–º—è –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ (–Ω–µ –ø—É—Å—Ç–æ–µ)
   - –£—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–Ω–µ null)
4. –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ `Add-Computer` —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:
   ```powershell
   Add-Computer -DomainName $domain -Credential $credential -NewName $computerName -Restart
   ```
5. –°–æ–∑–¥–∞–Ω–∏–µ –º–∞—Ä–∫–µ—Ä–∞ –ø—Ä–∏ —É—Å–ø–µ—Ö–µ

### 3. –ö–æ–¥—ã –≤–æ–∑–≤—Ä–∞—Ç–∞
| –ö–æ–¥ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|-----|----------|
| 0 | –£—Å–ø–µ—à–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ |
| 1 | –û—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è |
| 2 | –û—Ç–º–µ–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º |

---

## ‚ö†Ô∏è –¢–∏–ø–æ–≤—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

| –û—à–∏–±–∫–∞ | –†–µ—à–µ–Ω–∏–µ |
|--------|---------|
| **¬´Computer already exists¬ª** | –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `-Options JoinWithNewName` –≤ `Add-Computer` |
| **¬´Access denied¬ª** | –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏ –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ –≤ OU |
| **¬´Network path not found¬ª** | –£–±–µ–¥–∏—Ç–µ—Å—å –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏ DNS-–Ω–∞—Å—Ç—Ä–æ–µ–∫ |
| **–ú–∞—Ä–∫–µ—Ä –Ω–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è** | –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –Ω–∞ –∑–∞–ø–∏—Å—å –≤ `C:\Users\Public\` |

---

## üîß –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### 1. –†–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
```powershell
Start-Transcript -Path "C:\Logs\domain_join_$(Get-Date -Format 'yyyyMMdd').log"
```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–º–µ–Ω–∏ –≤ –¥–æ–º–µ–Ω–µ (—Å–µ–π—á–∞—Å –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –≤–æ –≤—Ä–µ–º—è –≤–≤–æ–¥–∞ –ø–∫ –≤ –¥–æ–º–µ–Ω)
```powershell
try {
    $exists = [bool](Get-ADComputer -Identity $computerName -ErrorAction Stop)
    if ($exists) { throw "–ö–æ–º–ø—å—é—Ç–µ—Ä —Å –∏–º–µ–Ω–µ–º $computerName —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç" }
} catch [Microsoft.ActiveDirectory.Management.ADIdentityNotFoundException] {
    # –ö–æ–º–ø—å—é—Ç–µ—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω - –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–º—è
}
```

### 3. Post-join –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
```powershell
# –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–¥ Restart:
Set-ItemProperty -Path "HKLM:\SOFTWARE\YourCompany" -Name "DomainJoined" -Value "True"
```

---

**–î–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è** | –ü–µ—Ä–µ–¥ –º–∞—Å—Å–æ–≤—ã–º —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ–º –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –≤ —Ç–µ—Å—Ç–æ–≤–æ–π —Å—Ä–µ–¥–µ  
Copyright ¬© 2025 –ö–æ–¥–µ–ª—å–Ω–∏–∫ –ú–∞–∫—Å–∏–º –°–µ—Ä–≥–µ–µ–≤–∏—á | MIT License
